<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example Of Use With Survival Outcome • MiceExtVal</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="get-started-surv_files/libs/quarto-html/popper.min.js"></script><script src="get-started-surv_files/libs/quarto-html/tippy.umd.min.js"></script><link href="get-started-surv_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="get-started-surv_files/libs/quarto-html/light-border.css" rel="stylesheet">
<script src="get-started-surv_files/libs/kePrint-0.0.1/kePrint.js"></script><link href="get-started-surv_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example Of Use With Survival Outcome">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MiceExtVal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get-started-logreg.html">Example Of Use With Dichotomous Outcome</a></li>
    <li><a class="dropdown-item" href="../articles/get-started-surv.html">Example Of Use With Survival Outcome</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metodologianavarrabiomed/mice-ext-val/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example Of Use With Survival Outcome</h1>

      <p class="author">Asier Ballesteros Domínguez</p>


      <small class="dont-index">Source: <a href="https://github.com/metodologianavarrabiomed/mice-ext-val/blob/master/vignettes/get-started-surv.qmd" class="external-link"><code>vignettes/get-started-surv.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell">
<style type="text/css">
p {
  text-align: justify
}
</style>
</div>
<section class="section level5"><h5 id="required-libraries">Required Libraries<a class="anchor" aria-label="anchor" href="#required-libraries"></a>
</h5>
<p>The following code snippet lists all the libraries needed to run this report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://metodologianavarrabiomed.github.io/mice-ext-val">MiceExtVal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tidyverse packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># table formatting packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary" class="external-link">gtsummary</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># analysis required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice" class="external-link">mice</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></code></pre></div>
</div>
<p>In this vignette, we demonstrate how to use the <code>MiceExtVal</code> package to externally validate a prediction model with a survival outcome. Specifically, we will validate the Framingham model for cardiovascular risk prediction, see <span class="citation" data-cites="framingham">Wilson et al. (<a href="#ref-framingham" role="doc-biblioref">1998</a>)</span>, using a publicly available dataset obtained from <a href="https://www.kaggle.com" class="external-link">Kaggle</a>. The Framingham model is a Cox model that estimates 10-year risk of suffering a heart attack in patients 30-79 years old with no history of Coronary Heart Disease (CHD).</p>
<p>The example is organized into the following steps:</p>
<ol type="1">
<li>Exploring the dataset</li>
<li>Imputing missing data</li>
<li>Defining the Framingham model</li>
<li>Performing external validation</li>
</ol>
<p>This structure is designed to guide users through a typical workflow, highlighting how <code>MiceExtVal</code> can support robust validation of survival models using multiply imputed data.</p>
</section><section class="section level2"><h2 id="explore-the-dataset">Explore the Dataset<a class="anchor" aria-label="anchor" href="#explore-the-dataset"></a>
</h2>
<p>The first step of every external validation is to become familiar with the dataset. To perform an external validation of the Framingham model, we require a dataset that contains the relevant predictor variables used by the model. For this purpose, the <code>MiceExtVal</code> package includes a version of the Framingham dataset, originally shared on <a href="https://www.kaggle.com" class="external-link">Kaggle</a> by <a href="https://www.kaggle.com/datasets/shreyjain601/framingham-heart-study" class="external-link">Shrey Jain</a>. The dataset is accessible as <code><a href="../reference/framingham.html">MiceExtVal::framingham</a></code></p>
<p>This dataset includes key clinical and demographic variables needed to replicate the Framingham risk prediction. A summary of the dataset’s variables is provided in <a href="#tbl-summary-data" class="quarto-xref">Table 1</a>, which serves as a starting point for exploring the structure and content of the data.</p>
<div class="cell plain table-sm">
<div id="tbl-summary-data" class="cell plain table-sm quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 1: Summary table of the Framingham dataset
</figcaption><div aria-describedby="tbl-summary-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ibuckwtjjl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ibuckwtjjl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ibuckwtjjl thead, #ibuckwtjjl tbody, #ibuckwtjjl tfoot, #ibuckwtjjl tr, #ibuckwtjjl td, #ibuckwtjjl th {
  border-style: none;
}

#ibuckwtjjl p {
  margin: 0;
  padding: 0;
}

#ibuckwtjjl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ibuckwtjjl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ibuckwtjjl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ibuckwtjjl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ibuckwtjjl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibuckwtjjl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibuckwtjjl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibuckwtjjl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ibuckwtjjl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ibuckwtjjl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ibuckwtjjl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ibuckwtjjl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ibuckwtjjl .gt_spanner_row {
  border-bottom-style: hidden;
}

#ibuckwtjjl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ibuckwtjjl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ibuckwtjjl .gt_from_md > :first-child {
  margin-top: 0;
}

#ibuckwtjjl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ibuckwtjjl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ibuckwtjjl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ibuckwtjjl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ibuckwtjjl .gt_row_group_first td {
  border-top-width: 2px;
}

#ibuckwtjjl .gt_row_group_first th {
  border-top-width: 2px;
}

#ibuckwtjjl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibuckwtjjl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ibuckwtjjl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ibuckwtjjl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibuckwtjjl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibuckwtjjl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ibuckwtjjl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ibuckwtjjl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ibuckwtjjl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibuckwtjjl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibuckwtjjl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibuckwtjjl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibuckwtjjl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibuckwtjjl .gt_left {
  text-align: left;
}

#ibuckwtjjl .gt_center {
  text-align: center;
}

#ibuckwtjjl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ibuckwtjjl .gt_font_normal {
  font-weight: normal;
}

#ibuckwtjjl .gt_font_bold {
  font-weight: bold;
}

#ibuckwtjjl .gt_font_italic {
  font-style: italic;
}

#ibuckwtjjl .gt_super {
  font-size: 65%;
}

#ibuckwtjjl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ibuckwtjjl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ibuckwtjjl .gt_indent_1 {
  text-indent: 5px;
}

#ibuckwtjjl .gt_indent_2 {
  text-indent: 10px;
}

#ibuckwtjjl .gt_indent_3 {
  text-indent: 15px;
}

#ibuckwtjjl .gt_indent_4 {
  text-indent: 20px;
}

#ibuckwtjjl .gt_indent_5 {
  text-indent: 25px;
}

#ibuckwtjjl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ibuckwtjjl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table do-not-create-environment cell plain table-sm small caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead><tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>No</strong><br>
N = 8,469<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">
<strong>Yes</strong><br>
N = 3,158<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Sex, 1=male, 2=female</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    1</td>
<td class="gt_row gt_center" headers="stat_1">3,255 / 8,469 (38%)</td>
<td class="gt_row gt_center" headers="stat_2">1,767 / 3,158 (56%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    2</td>
<td class="gt_row gt_center" headers="stat_1">5,214 / 8,469 (62%)</td>
<td class="gt_row gt_center" headers="stat_2">1,391 / 3,158 (44%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Age, years</td>
<td class="gt_row gt_center" headers="stat_1">53.83 (9.43)</td>
<td class="gt_row gt_center" headers="stat_2">57.36 (9.45)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Total cholesterol, mg/dL</td>
<td class="gt_row gt_center" headers="stat_1">238.08 (44.17)</td>
<td class="gt_row gt_center" headers="stat_2">249.42 (47.47)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    (Missing)</td>
<td class="gt_row gt_center" headers="stat_1">299</td>
<td class="gt_row gt_center" headers="stat_2">110</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">HDL cholesterol, mg/dL</td>
<td class="gt_row gt_center" headers="stat_1">50.66 (15.63)</td>
<td class="gt_row gt_center" headers="stat_2">45.61 (15.00)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    (Missing)</td>
<td class="gt_row gt_center" headers="stat_1">6,220</td>
<td class="gt_row gt_center" headers="stat_2">2,380</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">LDL cholesterol, mg/dL</td>
<td class="gt_row gt_center" headers="stat_1">174.04 (45.78)</td>
<td class="gt_row gt_center" headers="stat_2">183.49 (49.24)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    (Missing)</td>
<td class="gt_row gt_center" headers="stat_1">6,220</td>
<td class="gt_row gt_center" headers="stat_2">2,381</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Systolic Blood Pressure, mmHg</td>
<td class="gt_row gt_center" headers="stat_1">133.63 (21.57)</td>
<td class="gt_row gt_center" headers="stat_2">143.54 (24.38)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Diastolic Blood Pressure, mmHg</td>
<td class="gt_row gt_center" headers="stat_1">82.08 (11.18)</td>
<td class="gt_row gt_center" headers="stat_2">85.62 (12.51)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Currently smoking, 0=No, 1=Yes</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    0</td>
<td class="gt_row gt_center" headers="stat_1">4,804 / 8,469 (57%)</td>
<td class="gt_row gt_center" headers="stat_2">1,794 / 3,158 (57%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    1</td>
<td class="gt_row gt_center" headers="stat_1">3,665 / 8,469 (43%)</td>
<td class="gt_row gt_center" headers="stat_2">1,364 / 3,158 (43%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Diabetes, 0=No, 1=Yes</td>
<td class="gt_row gt_center" headers="stat_1"><br></td>
<td class="gt_row gt_center" headers="stat_2"><br></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">    0</td>
<td class="gt_row gt_center" headers="stat_1">8,219 / 8,469 (97%)</td>
<td class="gt_row gt_center" headers="stat_2">2,878 / 3,158 (91%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">    1</td>
<td class="gt_row gt_center" headers="stat_1">250 / 8,469 (3.0%)</td>
<td class="gt_row gt_center" headers="stat_2">280 / 3,158 (8.9%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Time of follow up, days</td>
<td class="gt_row gt_center" headers="stat_1">8,063.37 (1,648.67)</td>
<td class="gt_row gt_center" headers="stat_2">4,178.32 (2,721.05)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="odd">
<td colspan="3" class="gt_footnote">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> n / N (%); Mean (SD)</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>The dataset contains some missing values, particularly in cholesterol-related variables such as <code>Total Cholesterol</code>, <code>HDL Cholesterol</code>, and <code>LDL Cholesterol</code>. These missing values must be addressed before proceeding with model validation. <a href="#tbl-perc-miss" class="quarto-xref">Table 2</a> shows the percentage of missing data for each variable, highlighting the extent of missingness across the dataset.</p>
<div class="cell plain table-sm">
<div id="tbl-perc-miss" class="cell plain table-sm quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-perc-miss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 2: Percentage of missings
</figcaption><div aria-describedby="tbl-perc-miss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell plain table-sm small caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Percentage of Missings</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ldlc</td>
<td style="text-align: center;">73.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">hdlc</td>
<td style="text-align: center;">73.97</td>
</tr>
<tr class="odd">
<td style="text-align: left;">totchol</td>
<td style="text-align: center;">3.52</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section class="section level2"><h2 id="impute-missing-data">Impute Missing Data<a class="anchor" aria-label="anchor" href="#impute-missing-data"></a>
</h2>
<p>To address the missing values, we will use the <code>mice</code> package to perform multiple imputation, see <span class="citation" data-cites="mice-package">van Buuren &amp; Groothuis-Oudshoorn (<a href="#ref-mice-package" role="doc-biblioref">2011</a>)</span>. In this vignette, we apply the default imputation method provided by <code>mice</code>, as our primary goal is not to optimize the imputation itself but to demonstrate a realistic use case in which missing data must be handled prior to external validation. This step allows us to proceed with validating one or more prediction models using the imputed dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_matrix</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/make.predictorMatrix.html" class="external-link">make.predictorMatrix</a></span><span class="op">(</span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="va"><a href="../reference/framingham.html">framingham</a></span><span class="op">)</span></span>
<span><span class="va">pred_matrix</span><span class="op">[</span>, <span class="st">"randid"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pred_matrix</span><span class="op">[</span>, <span class="st">"period"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">mice_data</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="va"><a href="../reference/framingham.html">framingham</a></span><span class="op">)</span></span>
<span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="fu">mice</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html" class="external-link">complete</a></span><span class="op">(</span><span class="va">mice_data</span>, <span class="st">"long"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This report is aimed to show how the <code>MiceExtVal</code> package works it is not an explanation on how to impute missing data. If you need a further explanation of this methods please refer to <code>mice</code> explanations, <span class="citation" data-cites="vanBuuren2018 mice-package">(<a href="#ref-vanBuuren2018" role="doc-biblioref">Buuren, 2018</a>; <a href="#ref-mice-package" role="doc-biblioref">van Buuren &amp; Groothuis-Oudshoorn, 2011</a>)</span>. After the imputation the imputed datasets are stored in <code>fram_long</code> in long format.</p>
</section><section class="section level2"><h2 id="the-framingham-model">The Framingham Model<a class="anchor" aria-label="anchor" href="#the-framingham-model"></a>
</h2>
<p>With the data prepared, the next step is to examine the prediction model we intend to validate: the Framingham risk model, see <span class="citation" data-cites="framingham">Wilson et al. (<a href="#ref-framingham" role="doc-biblioref">1998</a>)</span>. This model is based on a Cox proportional hazards regression and is designed to estimate the risk of developing coronary heart disease in individuals aged 30 to 79 years. The model includes several clinical and demographic predictors, and its estimated coefficients are presented in <a href="#tbl-framingham-coefficients" class="quarto-xref">Table 3</a>.</p>
<div class="cell plain table-sm" data-tbl.alt="Framingham model coefficients ">
<div id="tbl-framingham-coefficients" class="cell plain table-sm quarto-float quarto-figure quarto-figure-center" data-tbl.alt="Framingham model coefficients ">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-framingham-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 3: Framingham model coefficients
</figcaption><div aria-describedby="tbl-framingham-coefficients-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell plain table-sm small caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Men</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Women</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: center;">0.0483</td>
<td style="text-align: center;">0.3377</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age squared</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-0.0027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Diabetes</td>
<td style="text-align: center;">0.4284</td>
<td style="text-align: center;">0.5963</td>
</tr>
<tr class="even">
<td style="text-align: left;">Smoker</td>
<td style="text-align: center;">0.5234</td>
<td style="text-align: center;">0.2925</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="3" style="text-align: left; border-bottom: 1px solid;">TC, mg/dL</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">&lt;160</td>
<td style="text-align: center;">-0.6594</td>
<td style="text-align: center;">-0.2614</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">160-199</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">200-239</td>
<td style="text-align: center;">0.1769</td>
<td style="text-align: center;">0.2077</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">240-279</td>
<td style="text-align: center;">0.5054</td>
<td style="text-align: center;">0.2439</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">&gt;280</td>
<td style="text-align: center;">0.6571</td>
<td style="text-align: center;">0.5351</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="3" style="text-align: left; border-bottom: 1px solid;">HDL-C, mg/dL</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">&lt;35</td>
<td style="text-align: center;">0.4974</td>
<td style="text-align: center;">0.8431</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">35-44</td>
<td style="text-align: center;">0.2431</td>
<td style="text-align: center;">0.3780</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">45-49</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.1978</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">50-59</td>
<td style="text-align: center;">-0.0511</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">&gt;60</td>
<td style="text-align: center;">-0.4866</td>
<td style="text-align: center;">-0.4295</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="3" style="text-align: left; border-bottom: 1px solid;">Blood Pressure</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Optimal</td>
<td style="text-align: center;">-0.0023</td>
<td style="text-align: center;">-0.5336</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Normal</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">High Normal</td>
<td style="text-align: center;">0.2832</td>
<td style="text-align: center;">-0.0677</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Stage I hypertension</td>
<td style="text-align: center;">0.5217</td>
<td style="text-align: center;">0.2629</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Stage II-IV hypertension</td>
<td style="text-align: center;">0.6186</td>
<td style="text-align: center;">0.4657</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Baseline survival function at 10 years, S(t)</td>
<td style="text-align: center;">0.9002</td>
<td style="text-align: center;">0.9625</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Most of the variables are categorical, this type of variables must be represented as numeric. If any variable is multicategorical as <code>Total Cholesterol</code> we need to generate as many dichotomous variables as categories. This type of representation is usually used in the mathematical formula definition of the models.</p>
<section class="level2"><h3 id="requirements-to-define-the-model">Requirements to Define the Model<a class="anchor" aria-label="anchor" href="#requirements-to-define-the-model"></a>
</h3>
<p>Before we can define the Framingham model in the <code>MiceExtVal</code> package for validation we must ensure that the predictor variables in our dataset are consistent with those used in the original derivation cohort. Although the dataset includes the necessary information to calculate each patient’s risk, several variables need to be transformed to match the model or the package specifications.</p>
<p>As shown in <a href="#tbl-framingham-coefficients" class="quarto-xref">Table 3</a>, some continuous variables—specifically <code>Total Cholesterol</code>,<code>HDL Cholesterol</code>, and <code>Blood Pressure</code> were categorized in the original model. Therefore, we will recode these variables accordingly before applying the model to our data.</p>
<section class="level3"><h4 id="total-cholesterol">Total Cholesterol<a class="anchor" aria-label="anchor" href="#total-cholesterol"></a>
</h4>
<p>The total cholesterol variable is categorized into five categories, less than <span class="math inline">\(160\)</span> mg/dL, between <span class="math inline">\(160\)</span> and <span class="math inline">\(199\)</span> mg/dL, between <span class="math inline">\(200\)</span> and <span class="math inline">\(239\)</span> mg/dL, between <span class="math inline">\(240\)</span> and <span class="math inline">\(279\)</span> mg/dl, and more than <span class="math inline">\(280\)</span> mg/dL. The following code snippet generates the variable in the dataset.</p>
<table class="table plain table-sm small caption-top">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Men</th>
<th style="text-align: right;">Women</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>TC, mg/dL</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;160</td>
<td style="text-align: right;">-0.6594</td>
<td style="text-align: right;">-0.2614</td>
</tr>
<tr class="odd">
<td style="text-align: left;">160-199</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">200-239</td>
<td style="text-align: right;">0.1769</td>
<td style="text-align: right;">0.2077</td>
</tr>
<tr class="odd">
<td style="text-align: left;">240-279</td>
<td style="text-align: right;">0.5054</td>
<td style="text-align: right;">0.2439</td>
</tr>
<tr class="even">
<td style="text-align: left;">&gt;280</td>
<td style="text-align: right;">0.6571</td>
<td style="text-align: right;">0.5351</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    totchol_less_160 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">totchol</span> <span class="op">&lt;</span> <span class="fl">160</span><span class="op">)</span>,</span>
<span>    totchol_160_199 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">totchol</span> <span class="op">&gt;=</span> <span class="fl">160</span> <span class="op">&amp;</span> <span class="va">totchol</span> <span class="op">&lt;</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>    totchol_200_239 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">totchol</span> <span class="op">&gt;=</span> <span class="fl">200</span> <span class="op">&amp;</span> <span class="va">totchol</span> <span class="op">&lt;</span> <span class="fl">240</span><span class="op">)</span>,</span>
<span>    totchol_240_279 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">totchol</span> <span class="op">&gt;=</span> <span class="fl">240</span> <span class="op">&amp;</span> <span class="va">totchol</span> <span class="op">&lt;</span> <span class="fl">280</span><span class="op">)</span>,</span>
<span>    totchol_greater_280 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">totchol</span> <span class="op">&gt;=</span> <span class="fl">280</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="hdl-cholesterol">HDL Cholesterol<a class="anchor" aria-label="anchor" href="#hdl-cholesterol"></a>
</h4>
<p>The Framingham model characterizes the HDL cholesterol into five groups, less than <span class="math inline">\(35\)</span> mg/dL, between <span class="math inline">\(35\)</span> and <span class="math inline">\(44\)</span> mg/dL, between <span class="math inline">\(45\)</span> and <span class="math inline">\(49\)</span> mg/dL, between <span class="math inline">\(50\)</span> and <span class="math inline">\(59\)</span> mg/dL, and more than <span class="math inline">\(60\)</span> mg/dL. As before the following code snippet generates the variable in the dataset.</p>
<table class="table plain table-sm small caption-top">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Men</th>
<th style="text-align: right;">Women</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>HDL, mg/dL</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">&lt;35</td>
<td style="text-align: right;">0.49744</td>
<td style="text-align: right;">0.84312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">35-44</td>
<td style="text-align: right;">0.24310</td>
<td style="text-align: right;">0.37796</td>
</tr>
<tr class="even">
<td style="text-align: left;">45-49</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">0.19785</td>
</tr>
<tr class="odd">
<td style="text-align: left;">50-59</td>
<td style="text-align: right;">-0.05107</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">&gt;60</td>
<td style="text-align: right;">-0.48660</td>
<td style="text-align: right;">-0.42951</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    hdl_less_35 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hdlc</span> <span class="op">&lt;</span> <span class="fl">35</span><span class="op">)</span>,</span>
<span>    hdl_35_44 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hdlc</span> <span class="op">&gt;=</span> <span class="fl">35</span> <span class="op">&amp;</span> <span class="va">hdlc</span> <span class="op">&lt;</span> <span class="fl">44</span><span class="op">)</span>,</span>
<span>    hdl_45_49 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hdlc</span> <span class="op">&gt;=</span> <span class="fl">45</span> <span class="op">&amp;</span> <span class="va">hdlc</span> <span class="op">&lt;</span> <span class="fl">49</span><span class="op">)</span>,</span>
<span>    hdl_50_59 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hdlc</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">hdlc</span> <span class="op">&lt;</span> <span class="fl">59</span><span class="op">)</span>,</span>
<span>    hdl_greater_60 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hdlc</span> <span class="op">&gt;=</span> <span class="fl">60</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="blood-pressure">Blood Pressure<a class="anchor" aria-label="anchor" href="#blood-pressure"></a>
</h4>
<p>In the model it is defined a variable that aggregates the systolyc blood pressure and diastolic blood pressure into five groups of hypertension. As defined by <span class="citation" data-cites="framingham">Wilson et al. (<a href="#ref-framingham" role="doc-biblioref">1998</a>)</span>, we categorize each of the individual blood pressure variables into five groups, optimal, normal, high-normal, hypertension I, and hypertension II-IV. If a patient have different blood pressure categories we use the highest one as a representation of they state. The following code adds the variable to the dataset, we first generate the individual categorization variables and generate the <code>pressure</code> variable as the aggregation of both.</p>
<table class="table plain table-sm small caption-top">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Men</th>
<th style="text-align: right;">Women</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Blood Pressure</strong></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Optimal</td>
<td style="text-align: right;">-0.00226</td>
<td style="text-align: right;">-0.53363</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Normal</td>
<td style="text-align: right;">-</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">High Normal</td>
<td style="text-align: right;">0.28320</td>
<td style="text-align: right;">-0.06773</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stage I hypertension</td>
<td style="text-align: right;">0.52168</td>
<td style="text-align: right;">0.26288</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stage II-IV hypertension</td>
<td style="text-align: right;">0.61859</td>
<td style="text-align: right;">0.46573</td>
</tr>
</tbody>
</table>
<p>We first generate a variable called <code>pressure</code> that categorize both pressures into one variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pressure_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"optimal"</span>, <span class="st">"normal"</span>, <span class="st">"high-normal"</span>, <span class="st">"hypertension I"</span>, <span class="st">"hypertension II-IV"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    sys_lvl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span>
<span>      <span class="va">sysbp</span>,</span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">120</span>, <span class="fl">130</span>, <span class="fl">140</span>, <span class="fl">160</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="va">pressure_labels</span></span>
<span>    <span class="op">)</span>,</span>
<span>    dys_lvl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span>
<span>      <span class="va">diabp</span>,</span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">80</span>, <span class="fl">85</span>, <span class="fl">90</span>, <span class="fl">100</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="va">pressure_labels</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pressure <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_int</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sys_lvl</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dys_lvl</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pressure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">pressure</span>,</span>
<span>      labels <span class="op">=</span> <span class="va">pressure_labels</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<p>We can generate the different variables used in the model from the <code>pressure</code> variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    bp_optimal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pressure</span> <span class="op">==</span> <span class="st">"optimal"</span><span class="op">)</span>,</span>
<span>    bp_high_normal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pressure</span> <span class="op">==</span> <span class="st">"high-normal"</span><span class="op">)</span>,</span>
<span>    bp_hypertension_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pressure</span> <span class="op">==</span> <span class="st">"hypertension I"</span><span class="op">)</span>,</span>
<span>    bp_hypertension_ii_iv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pressure</span> <span class="op">==</span> <span class="st">"hypertension II-IV"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="generating-extra-needed-variables">Generating Extra Needed Variables<a class="anchor" aria-label="anchor" href="#generating-extra-needed-variables"></a>
</h4>
<p>Some variables like <code>cursmoke</code> or <code>diabetes</code> are factors and to be used in the model we need to transform them to numeric variables where <span class="math inline">\(1\)</span> indicates <code>TRUE</code> and <span class="math inline">\(0\)</span> indicates <code>FALSE</code>. We will also generate the variable <code>age2</code> <span class="math inline">\(age^2\)</span> needed for the women model. Additionally, we also generate the survival outcome <code>anychd_surv</code> that is needed to define the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    cursmoke <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">cursmoke</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,</span>
<span>    diabetes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span>,</span>
<span>    age2 <span class="op">=</span> <span class="va">age</span><span class="op">**</span><span class="fl">2</span>,</span>
<span>    anychd_surv <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">timechd</span>, <span class="va">anychd</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</section></section></section><section class="section level2"><h2 id="external-validation">External Validation<a class="anchor" aria-label="anchor" href="#external-validation"></a>
</h2>
<p>Traditional external validation is typically performed on a single, complete dataset and involves several sequential steps. First, the original model is used to generate predictions for the new dataset. Then, the model’s performance is evaluated by assessing its discrimination (e.g. AUC) and calibration. If necessary, the model may be recalibrated, and performance metrics re-evaluated after adjustment.</p>
<p>However, when working with datasets containing missing values—especially in clinical research—multiple imputation is often used to preserve data integrity and avoid bias. As a result, we no longer have a single dataset, but multiple imputed versions of the original data, each representing a plausible completion. This complicates traditional validation workflows, since each imputed dataset yields different results that must be pooled appropriately.</p>
<p>The <code>MiceExtVal</code> package is designed to bridge this gap by streamlining the external validation process across multiple imputed datasets. It allows users to perform all validation steps—including prediction, performance evaluation, and optional recalibration while properly handling the variability introduced by imputation.</p>
<p>After generating the required Framingham variables, we can proceed to define the model using the <code>MiceExtVal</code> package. The original Framingham model is stratified by sex, meaning separate sets of coefficients are used for men and women. To reflect this structure, we will define two separate Cox models, one for each sex.</p>
<p>The <code>MiceExtVal</code> package provides the <code><a href="../reference/mv_model_cox.html">MiceExtVal::mv_model_cox()</a></code> function to specify Cox proportional hazards models that can be used with multiply imputed data. In the following steps, we will use this function to define both sex-specific models for external validation.</p>
<section class="level2"><h3 id="generate-the-models">Generate the Models<a class="anchor" aria-label="anchor" href="#generate-the-models"></a>
</h3>
<p>In the <code>MiceExtVal</code> package, models are defined using specialized constructors depending on the outcome type: use <code><a href="../reference/mv_model_cox.html">MiceExtVal::mv_model_cox()</a></code> for Cox proportional hazards models and <code><a href="../reference/mv_model_logreg.html">MiceExtVal::mv_model_logreg()</a></code> for logistic regression models. Since the Framingham model is a survival model based on the Cox framework, we will use <code><a href="../reference/mv_model_cox.html">MiceExtVal::mv_model_cox()</a></code> in this example.</p>
<p>To define a Cox model for external validation, the following key components must be provided:</p>
<ul>
<li>
<code>formula</code>: A formula specifying the structure of the model. This includes the predictor variables and their coefficients. If the original model was developed with centered variables, the formula should reflect that by subtracting the corresponding means to correctly compute the linear predictor (<span class="math inline">\(\beta \cdot X\)</span>).</li>
<li>
<code>S0</code>: The baseline survival probability <span class="math inline">\(S_0(t)\)</span> at a specific time point <span class="math inline">\(t\)</span>. For the Framingham model, predictions are made at 10 years, so we will use <span class="math inline">\(S_0(10 \text{ years})\)</span> as provided in the original publication.</li>
</ul>
<p>As the Framingham model is stratified by sex, we will define and validate two separate models—one for men and one for women—each with its corresponding formula and baseline survival value.</p>
<section class="level3"><h4 id="men">Men<a class="anchor" aria-label="anchor" href="#men"></a>
</h4>
<p>The next code snippet generates the men model formula following the original mean values and the coefficients described in the previous tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_formula</span> <span class="op">&lt;-</span> <span class="va">anychd_surv</span> <span class="op">~</span> <span class="fl">0.0483</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">48.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.4284</span> <span class="op">*</span> <span class="op">(</span><span class="va">diabetes</span> <span class="op">-</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5234</span> <span class="op">*</span> <span class="op">(</span><span class="va">cursmoke</span> <span class="op">-</span> <span class="fl">0.403</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.6595</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_less_160</span> <span class="op">-</span> <span class="fl">0.075</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1769</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_200_239</span> <span class="op">-</span> <span class="fl">0.39</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.5054</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_240_279</span> <span class="op">-</span> <span class="fl">0.165</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.6571</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_greater_280</span> <span class="op">-</span> <span class="fl">0.057</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.4974</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_less_35</span> <span class="op">-</span> <span class="fl">0.192</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2431</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_35_44</span> <span class="op">-</span> <span class="fl">0.357</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.0511</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_50_59</span> <span class="op">-</span> <span class="fl">0.19</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.4866</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_greater_60</span> <span class="op">-</span> <span class="fl">0.106</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.0023</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_optimal</span> <span class="op">-</span> <span class="fl">0.202</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2832</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_high_normal</span> <span class="op">-</span> <span class="fl">0.202</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.5217</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_hypertension_i</span> <span class="op">-</span> <span class="fl">0.225</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.6186</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_hypertension_ii_iv</span> <span class="op">-</span> <span class="fl">0.128</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Once we have defined the needed parameters of the model we can create the model as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/mv_model_cox.html">mv_model_cox</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">men_formula</span>,</span>
<span>  S0 <span class="op">=</span> <span class="fl">0.9002</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="women">Women<a class="anchor" aria-label="anchor" href="#women"></a>
</h4>
<p>For women we can reproduce what we have already done for men.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">women_formula</span> <span class="op">&lt;-</span> <span class="va">anychd_surv</span> <span class="op">~</span> <span class="fl">0.3377</span> <span class="op">*</span> <span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">49.6</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.0027</span> <span class="op">*</span> <span class="op">(</span><span class="va">age2</span> <span class="op">-</span> <span class="fl">2604.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5963</span> <span class="op">*</span> <span class="op">(</span><span class="va">diabetes</span> <span class="op">-</span> <span class="fl">0.038</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.2925</span> <span class="op">*</span> <span class="op">(</span><span class="va">cursmoke</span> <span class="op">-</span> <span class="fl">0.378</span><span class="op">)</span> <span class="op">+</span> <span class="op">-</span><span class="fl">0.2614</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_less_160</span> <span class="op">-</span> <span class="fl">0.079</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.2077</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_200_239</span> <span class="op">-</span> <span class="fl">0.327</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2439</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_240_279</span> <span class="op">-</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.5351</span> <span class="op">*</span> <span class="op">(</span><span class="va">totchol_greater_280</span> <span class="op">-</span> <span class="fl">0.91</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.8431</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_less_35</span> <span class="op">-</span> <span class="fl">0.043</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.378</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_35_44</span> <span class="op">-</span> <span class="fl">0.149</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1978</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_45_49</span> <span class="op">-</span> <span class="fl">0.124</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.4295</span> <span class="op">*</span> <span class="op">(</span><span class="va">hdl_greater_60</span> <span class="op">-</span> <span class="fl">0.407</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5336</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_optimal</span> <span class="op">-</span> <span class="fl">0.348</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fl">0.0677</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_high_normal</span> <span class="op">-</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2629</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_hypertension_i</span> <span class="op">-</span> <span class="fl">0.186</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">0.4657</span> <span class="op">*</span> <span class="op">(</span><span class="va">bp_hypertension_ii_iv</span> <span class="op">-</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<p>From the previous parameters we generate the <code>women_model</code> to externally validate the Framingham women model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/mv_model_cox.html">mv_model_cox</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">women_formula</span>,</span>
<span>  S0 <span class="op">=</span> <span class="fl">0.9625</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="level2"><h3 id="generate-stratified-datasets">Generate Stratified Datasets<a class="anchor" aria-label="anchor" href="#generate-stratified-datasets"></a>
</h3>
<p>As the Framingham model is defined as an stratified model we need to generate the stratified datasets. Each model results must be calculated in their respective subcohort of the dataset. To obtain the subcohorts we simply filter the data for each of the genders and generate <code>men_fram_long</code> and <code>women_fram_long</code> variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">women_fram_long</span> <span class="op">&lt;-</span> <span class="va">fram_long</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="external-validation-results">External Validation Results<a class="anchor" aria-label="anchor" href="#external-validation-results"></a>
</h3>
<p>Once we’ve defined the Framingham model using the <code>MiceExtVal</code> package, we can proceed to perform external validation. The functions in the package are organized into two main categories:</p>
<ul>
<li>Functions that calculate predictions or other results based on the model definition begin with <code>calculate_</code>.</li>
<li>Functions that obtain the external validation results begin with <code>get_</code>.</li>
</ul>
<p>The external validation process can be divided into three main phases:</p>
<ol type="1">
<li>Calculate Predictions: This step involves generating predicted risk scores for the individuals in the validation cohort.</li>
<li>Calculate Recalibrations: If necessary, recalibration of the model is performed to adjust for any systematic differences between the derivation and validation cohorts.</li>
<li>Obtain External Validation Results: This final step generates the validation metrics, such as discrimination and calibration, that assess the model’s performance in the external dataset.</li>
</ol></section><section class="level2"><h3 id="calculate-the-predictions">Calculate the predictions<a class="anchor" aria-label="anchor" href="#calculate-the-predictions"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions.html">calculate_predictions</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">men_fram_long</span><span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions.html">calculate_predictions</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">women_fram_long</span><span class="op">)</span></span></code></pre></div>
</div>
<p>After executing <code><a href="../reference/calculate_predictions.html">MiceExtVal::calculate_predictions()</a></code>, the model object is updated with additional information derived from the imputed dataset. Specifically, the predicted probabilities are computed for each imputation and stored within the model. In addition, the function calculates aggregated predictions for each patient by pooling results across imputations. An example of these values are shown in <a href="#tbl-model-predictions-example" class="quarto-xref">Table 4</a>.</p>
<div id="tbl-model-predictions-example" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-predictions-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 4: Men Framingham model predictions
</figcaption><div aria-describedby="tbl-model-predictions-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-model-predictions-example" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-model-predictions-example-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-model-predictions-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Aggregated predictions
</figcaption><div aria-describedby="tbl-model-predictions-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-model-predictions-example-1" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prediction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2448</td>
<td style="text-align: right;">0.040</td>
</tr>
<tr class="even">
<td style="text-align: left;">9428</td>
<td style="text-align: right;">0.153</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14367</td>
<td style="text-align: right;">0.157</td>
</tr>
<tr class="even">
<td style="text-align: left;">16365</td>
<td style="text-align: right;">0.152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20375</td>
<td style="text-align: right;">0.230</td>
</tr>
<tr class="even">
<td style="text-align: left;">33077</td>
<td style="text-align: right;">0.149</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-model-predictions-example" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-model-predictions-example-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-model-predictions-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Model predictions in each imputation
</figcaption><div aria-describedby="tbl-model-predictions-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-model-predictions-example-2" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">prediction</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.imp</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2448</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">9428</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.153</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">14367</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">16365</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">20375</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">33077</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>Beyond the predicted probabilities, the model object also includes the prognostic indexes (<span class="math inline">\(\beta \cdot X\)</span>), both at the individual imputation level and as pooled estimates. <a href="#tbl-model-betax-example" class="quarto-xref">Table 5</a> presents these values.</p>
<div id="tbl-model-betax-example" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-betax-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 5: Men Framingham model Beta X
</figcaption><div aria-describedby="tbl-model-betax-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-model-betax-example" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-model-betax-example-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-model-betax-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Aggregated Beta X
</figcaption><div aria-describedby="tbl-model-betax-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-model-betax-example-1" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">betax</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2448</td>
<td style="text-align: right;">-0.953</td>
</tr>
<tr class="even">
<td style="text-align: left;">9428</td>
<td style="text-align: right;">0.452</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14367</td>
<td style="text-align: right;">0.477</td>
</tr>
<tr class="even">
<td style="text-align: left;">16365</td>
<td style="text-align: right;">0.405</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20375</td>
<td style="text-align: right;">0.882</td>
</tr>
<tr class="even">
<td style="text-align: left;">33077</td>
<td style="text-align: right;">0.408</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-model-betax-example" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-model-betax-example-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-model-betax-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Model Beta X in each imputation
</figcaption><div aria-describedby="tbl-model-betax-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-model-betax-example-2" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">betax</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">.imp</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-1.199</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2448</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.216</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">9428</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.459</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">14367</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.559</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">16365</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.087</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">20375</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.719</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">33077</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section class="level2"><h3 id="model-performance">Model Performance<a class="anchor" aria-label="anchor" href="#model-performance"></a>
</h3>
<p>The model performance can be separated in two. The ability of the model to discriminate high-risk patients from low-risk patients and its calibration i.e. the ability to match the real risk and predicted risk. The package provides different functions depending on the type of outcome and model that it is externally validated. In this case as we are externally validating a Cox model we will use the functions associated to this model and a survival outcome.</p>
<section class="level3"><h4 id="calculating-c-index">Calculating C-Index<a class="anchor" aria-label="anchor" href="#calculating-c-index"></a>
</h4>
<p>The model discrimination ability is calculated with the C-index or AUC. The package provides users with two functions, <code><a href="../reference/calculate_auc.html">MiceExtVal::calculate_auc()</a></code> for the AUC calculation and <code><a href="../reference/calculate_harrell_c_index.html">MiceExtVal::calculate_harrell_c_index()</a></code> that calculates the Harrell C-Index. Both functions require that the model predictions are already calculated. In our case we are externally validating a Cox model, so we can calculate the C-Index in both models by using the <code><a href="../reference/calculate_harrell_c_index.html">MiceExtVal::calculate_harrell_c_index()</a></code> function.</p>
<div class="cell plain table-sm">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_harrell_c_index.html">calculate_harrell_c_index</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">men_fram_long</span><span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_harrell_c_index.html">calculate_harrell_c_index</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">women_fram_long</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">men_model</span><span class="op">[[</span><span class="st">"c_index"</span><span class="op">]</span><span class="op">]</span>, <span class="va">women_model</span><span class="op">[[</span><span class="st">"c_index"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div id="tbl-c-index" class="cell plain table-sm quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-c-index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 6: C-Index results
</figcaption><div aria-describedby="tbl-c-index-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell plain table-sm small caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI L</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI U</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">P-val</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Men</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Women</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">0.682</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In this article we also show how to recalibrate the model with the two techniques provided in the package. This recalibration of the predictions does not modify the value of the C-Index because all the predictions are modified using the same parameters of recalibration. As all the variable are modified equally the order of the predictions are not modified and therefore the C-Index remains unchanged.</p>
</section><section class="level3"><h4 id="calculating-calibration-plot">Calculating Calibration Plot<a class="anchor" aria-label="anchor" href="#calculating-calibration-plot"></a>
</h4>
<p>The calibration plots help users to visualize how accurate are the model predictions to the observed risks. To calculate the calibration plots it is mandatory to have calculated before the model predictions or they recalibration if needed. The package provides the user with some functions that allow them to generate the calibration plots.</p>
<p>The calibration plot calculation is divided into two steps, first step calculates the data where observed and predicted risks are represented. The observed risk can be calculated in different ways, in the package we have defined two function that allow the users to calculate them. The <code><a href="../reference/get_calibration_plot_data_surv.html">MiceExtVal::get_calibration_plot_data_surv()</a></code> function calculates the observed risk by a Kaplan-Meier estimator and the <code><a href="../reference/get_calibration_plot_data_prop.html">MiceExtVal::get_calibration_plot_data_prop()</a></code> function that calculates the observed risk as the proportion of events. From this data the calibration plot can be generated using the <code><a href="../reference/get_calibration_plot.html">MiceExtVal::get_calibration_plot()</a></code> function. The following code snippet shows how to calculate the calibration plots for the Framingham models.</p>
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_aggregated"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_aggregated"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="fig-framingham-cal-plot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-framingham-cal-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-1" class="quarto-float quarto-figure quarto-figure-center" alt="Calibration plot for original predictions in men and women ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-1.png" data-ref-parent="fig-framingham-cal-plot" alt="Calibration plot for original predictions in men and women " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Men
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-2" class="quarto-float quarto-figure quarto-figure-center" alt="Calibration plot for original predictions in men and women ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-2.png" data-ref-parent="fig-framingham-cal-plot" alt="Calibration plot for original predictions in men and women " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Women
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-framingham-cal-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 1: Framingham original predictions calibration plots
</figcaption></figure>
</div>
<p>The calibration plots are a <code>ggplot</code> object and they can be modified as any other plot of the <code>ggplot2</code> package. Feel free to modify them to match your requirements.</p>
</section><section class="level3"><h4 id="calculation-brier-score">Calculation Brier Score<a class="anchor" aria-label="anchor" href="#calculation-brier-score"></a>
</h4>
<p>The Brier score is an statistic that measure the accuracy between the predicted riska and the observed outcome. In survival analysis we do no have an observed risk for each of the patients. Neverteless we can assume that the outcome is dichotomous and calculate the Brier score with this type of outcome. The statistic is calculated as:</p>
<p><span class="math display">\[
BS = \frac{1}{N}\sum^N_{t = 1}(f_t - o_t)^2
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the size of the population, <span class="math inline">\(f_t\)</span> is the model prediction for the patient <span class="math inline">\(t\)</span> and <span class="math inline">\(o_t\)</span> is the observed risk for the patient <span class="math inline">\(t\)</span> in this case <span class="math inline">\(0\)</span> if they suffer no event and <span class="math inline">\(1\)</span> otherwise.</p>
<p>In the <code>MiceExtVal</code> package we have developed the function <code><a href="../reference/calculate_brier_score.html">MiceExtVal::calculate_brier_score</a></code> that help users to calculate the model brier score.</p>
<div class="cell plain table-sm">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_aggregated"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_aggregated"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">men_model</span><span class="op">[[</span><span class="st">"brier_score"</span><span class="op">]</span><span class="op">]</span>, <span class="va">women_model</span><span class="op">[[</span><span class="st">"brier_score"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div id="tbl-brier-score" class="cell plain table-sm quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-brier-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 7: Brier score results
</figcaption><div aria-describedby="tbl-brier-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell plain table-sm small caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI L</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI U</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Men</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.270</td>
</tr>
<tr class="even">
<td style="text-align: left;">Women</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">0.192</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-brier-score" class="quarto-xref">Table 7</a> there are represented the brier score results for both models. It is important to remark that they are not comparable between them as they are calculated over different subcohorts of the framingham complete cohort.</p>
</section></section><section class="level2"><h3 id="recalibration">Recalibration<a class="anchor" aria-label="anchor" href="#recalibration"></a>
</h3>
<p>When we are validating a model in an external cohort is common that the model predictions do not match the observed risks in the new cohort. To minimize this problem we have developed two functions that allow the users to recalibrate the model predictions (please refer to <code><a href="../reference/calculate_predictions_recalibrated_type_1.html">MiceExtVal::calculate_predictions_recalibrated_type_1()</a></code> and <code><a href="../reference/calculate_predictions_recalibrated_type_2.html">MiceExtVal::calculate_predictions_recalibrated_type_2()</a></code> documentation for more detailed information on how the recalibration works).</p>
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions_recalibrated_type_1.html">calculate_predictions_recalibrated_type_1</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">men_fram_long</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions_recalibrated_type_2.html">calculate_predictions_recalibrated_type_2</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">men_fram_long</span><span class="op">)</span></span>
<span></span>
<span><span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_recal_type_1"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_recal_type_2"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="fig-framingham-cal-plot-recal-men" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-framingham-cal-plot-recal-men-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot-recal-men" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-recal-men-1" class="quarto-float quarto-figure quarto-figure-center" alt="Type 1 and type 2 calibration plots for men ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-recal-men-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-recal-men-1.png" data-ref-parent="fig-framingham-cal-plot-recal-men" alt="Type 1 and type 2 calibration plots for men " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-recal-men-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Type 1 recalibration
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot-recal-men" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-recal-men-2" class="quarto-float quarto-figure quarto-figure-center" alt="Type 1 and type 2 calibration plots for men ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-recal-men-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-recal-men-2.png" data-ref-parent="fig-framingham-cal-plot-recal-men" alt="Type 1 and type 2 calibration plots for men " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-recal-men-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Type 2 recalibration
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-framingham-cal-plot-recal-men-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 2: Framingham recalibrated calibration plots in men
</figcaption></figure>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions_recalibrated_type_1.html">calculate_predictions_recalibrated_type_1</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">women_fram_long</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_predictions_recalibrated_type_2.html">calculate_predictions_recalibrated_type_2</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_recal_type_1"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot_data_surv.html">get_calibration_plot_data_surv</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>,</span>
<span>    n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"predictions_recal_type_2"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_calibration_plot.html">get_calibration_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div id="fig-framingham-cal-plot-recal-women" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-framingham-cal-plot-recal-women-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot-recal-women" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-recal-women-1" class="quarto-float quarto-figure quarto-figure-center" alt="Type 1 and type 2 calibration plots for women ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-recal-women-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-recal-women-1.png" data-ref-parent="fig-framingham-cal-plot-recal-women" alt="Type 1 and type 2 calibration plots for women " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-recal-women-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Type 1 recalibration
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-framingham-cal-plot-recal-women" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-framingham-cal-plot-recal-women-2" class="quarto-float quarto-figure quarto-figure-center" alt="Type 1 and type 2 calibration plots for women ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-framingham-cal-plot-recal-women-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-framingham-cal-plot-recal-women-2.png" data-ref-parent="fig-framingham-cal-plot-recal-women" alt="Type 1 and type 2 calibration plots for women " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-framingham-cal-plot-recal-women-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Type 2 recalibration
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-framingham-cal-plot-recal-women-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 3: Framingham recalibrated calibration plots in women
</figcaption></figure>
</div>
<p>Type 1 and type 2 recalibration are not consecutive, they are just two different approaches for the same problem. As show in <a href="#fig-framingham-cal-plot-recal-men" class="quarto-xref">Figure 2</a>, <a href="#fig-framingham-cal-plot-recal-women" class="quarto-xref">Figure 3</a> they obtain similar results. With the recalibration it also changes the Brier score results as shown in <a href="#tbl-brier-score-recal" class="quarto-xref">Table 8</a>.</p>
<div class="cell plain table-sm" data-layout-nrow="2">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men_model</span> <span class="op">&lt;-</span> <span class="va">men_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_recal_type_1"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">men_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_recal_type_2"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">women_model</span> <span class="op">&lt;-</span> <span class="va">women_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_recal_type_1"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/calculate_brier_score.html">calculate_brier_score</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">women_fram_long</span>, type <span class="op">=</span> <span class="st">"predictions_recal_type_2"</span>, n_boot <span class="op">=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">men_model</span><span class="op">[[</span><span class="st">"brier_score_type_1"</span><span class="op">]</span><span class="op">]</span>, <span class="va">women_model</span><span class="op">[[</span><span class="st">"brier_score_type_1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">men_model</span><span class="op">[[</span><span class="st">"brier_score_type_2"</span><span class="op">]</span><span class="op">]</span>, <span class="va">women_model</span><span class="op">[[</span><span class="st">"brier_score_type_2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, .before <span class="op">=</span> <span class="st">"Estimate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div id="tbl-brier-score-recal" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-tbl"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-brier-score-recal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table 8: Brier score results with recalibrated data
</figcaption><div aria-describedby="tbl-brier-score-recal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-brier-score-recal" style="flex-basis: 100.0%;justify-content: center;">
<div id="tbl-brier-score-recal-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-brier-score-recal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Type 1 recalibration
</figcaption><div aria-describedby="tbl-brier-score-recal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-brier-score-recal-1" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI L</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI U</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Men</td>
<td style="text-align: right;">0.211</td>
<td style="text-align: right;">0.203</td>
<td style="text-align: right;">0.218</td>
</tr>
<tr class="even">
<td style="text-align: left;">Women</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.159</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-brier-score-recal" style="flex-basis: 100.0%;justify-content: center;">
<div id="tbl-brier-score-recal-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center" data-quarto-postprocess="true">
<figure class="quarto-float quarto-subfloat-tbl"><figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-brier-score-recal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Type 2 recalibration
</figcaption><div aria-describedby="tbl-brier-score-recal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-brier-score-recal-2" class="table do-not-create-environment caption-top" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI L</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI U</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Men</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">0.239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Women</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.160</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</section></section><section class="section level2"><h2 id="comparing-results">Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results"></a>
</h2>
<p>External validations are normally performed to compare different model performances among a certain cohort. The <code>MiceExtVal</code> package also provides users with functions that allow to compare results of different models.</p>
<section class="level3"><h4 id="calibration-comparison-stratified-calibration-plots">Calibration Comparison: Stratified Calibration Plots<a class="anchor" aria-label="anchor" href="#calibration-comparison-stratified-calibration-plots"></a>
</h4>
<p>In order to compare two model calibration plots we have developed the functions <code>MiceExtval::get_stratified_calibration_plot_surv()</code> and <code>MiceExtval::get_stratified_calibration_plot_prop()</code> that allow the user to plot stratified calibration plots. Accordingly with the individual calibration plots we use the function <code>MiceExtval::get_stratified_calibration_plot_surv()</code> to generate the stratified calibration plot.</p>
<p>In our case it could be interesting to plot men and women calibrations in the same plot, as shown in <a href="#fig-stratified-cal-plot" class="quarto-xref">Figure 4</a>. The function takes three arguments and a list of models as arguments.</p>
<ul>
<li>The external validation data (e.g., <code>fram_long</code>)</li>
<li>The number of groups</li>
<li>The type of prediction (either recalibrated or original predictions)</li>
<li>A list of models to compare (in this case, <code>men_model</code> and <code>women_model</code>).</li>
</ul>
<p>This will allow the function to overlay calibration plots for both models on the same figure, facilitating direct comparison.</p>
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_stratified_calibration_plot_surv.html">get_stratified_calibration_plot_surv</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">fram_long</span>,</span>
<span>  n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"predictions_aggregated"</span>,</span>
<span>  Men <span class="op">=</span> <span class="va">men_model</span>,</span>
<span>  Women <span class="op">=</span> <span class="va">women_model</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_stratified_calibration_plot_surv.html">get_stratified_calibration_plot_surv</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">fram_long</span>,</span>
<span>  n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"predictions_recal_type_1"</span>,</span>
<span>  Men <span class="op">=</span> <span class="va">men_model</span>,</span>
<span>  Women <span class="op">=</span> <span class="va">women_model</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_stratified_calibration_plot_surv.html">get_stratified_calibration_plot_surv</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">fram_long</span>,</span>
<span>  n_groups <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"predictions_recal_type_2"</span>,</span>
<span>  Men <span class="op">=</span> <span class="va">men_model</span>,</span>
<span>  Women <span class="op">=</span> <span class="va">women_model</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="fig-stratified-cal-plot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-stratified-cal-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stratified-cal-plot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-stratified-cal-plot-1" class="quarto-float quarto-figure quarto-figure-center" alt="Stratified calibration plot ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-stratified-cal-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-stratified-cal-plot-1.png" data-ref-parent="fig-stratified-cal-plot" alt="Stratified calibration plot " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stratified-cal-plot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Original predictions
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stratified-cal-plot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-stratified-cal-plot-2" class="quarto-float quarto-figure quarto-figure-center" alt="Stratified calibration plot ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-stratified-cal-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-stratified-cal-plot-2.png" data-ref-parent="fig-stratified-cal-plot" alt="Stratified calibration plot " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stratified-cal-plot-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Type 1 recalibration
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stratified-cal-plot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-stratified-cal-plot-3" class="quarto-float quarto-figure quarto-figure-center" alt="Stratified calibration plot ">
<figure class="quarto-float quarto-subfloat-fig"><div aria-describedby="fig-stratified-cal-plot-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-stratified-cal-plot-3.png" data-ref-parent="fig-stratified-cal-plot" alt="Stratified calibration plot " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stratified-cal-plot-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Type 2 recalibration
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stratified-cal-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 4: Framingham stratified by sex calibration plots
</figcaption></figure>
</div>
<p>Note that we pass the entire imputed dataset (<code>fram_long</code>) as an argument, even though each model only stores the results for its respective subcohort (men or women). This is necessary because the function needs access to the full dataset in order to correctly extract and process the relevant subcohort for each model. The function then uses the subcohort specified for each model (e.g., <code>men_model</code> for men) to calculate the appropriate calibration data and generate the corresponding calibration plots.</p>
<p>By passing the complete dataset, the function ensures that the stratified calibration plots are generated correctly, comparing the models’ calibration in the context of the full cohort’s distribution of characteristics.</p>
</section><section class="level3"><h4 id="discrimination-comparison-forestplot">Discrimination Comparison: Forestplot<a class="anchor" aria-label="anchor" href="#discrimination-comparison-forestplot"></a>
</h4>
<p>The <code>MiceExtVal</code> package also includes functionality for generating a forest plot to compare the discrimination abilities of different models. In this example, we will visualize the Harrell C-Index, but the package also allows for the comparison of the AUC (Area Under the Curve) in dichotomous outcomes.</p>
<p>The forest plot generation process is split into two steps:</p>
<ol type="1">
<li>Data preparation: The first step generates the data that will be used in the forest plot.</li>
<li>Forest plot creation: The second step generates the actual plot from the prepared data.</li>
</ol>
<p>To compare different models, we can stratify the results by binding data from different subgroups (e.g., men and women patients). Models that share the same name across subgroups will be merged in the final forest plot, making it easy to compare the performance of the same model in different groups.</p>
<p>In the following example, we generate two separate strata for the same model, <code>TIMI-II</code>, one for men and one for women, and then we pass these strata to the forest plot function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span>strat <span class="op">=</span> <span class="st">"Men"</span>, type <span class="op">=</span> <span class="st">"c_index"</span>, Framingham <span class="op">=</span> <span class="va">men_model</span><span class="op">)</span>,</span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span>strat <span class="op">=</span> <span class="st">"Women"</span>, type <span class="op">=</span> <span class="st">"c_index"</span>, Framingham <span class="op">=</span> <span class="va">women_model</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot.html">get_forestplot</a></span><span class="op">(</span>center <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-forestplot-stratified" class="quarto-float quarto-figure quarto-figure-center" alt="C-Indexes forestplot stratified ">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-forestplot-stratified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-forestplot-stratified-1.png" alt="C-Indexes forestplot stratified " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-forestplot-stratified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 5: Forestplot stratified
</figcaption></figure>
</div>
</div>
</div>
<p>If we want to generate a forestplot with multiple models in one strat we can generate it as the following example. In this example men and women models are inserted in the <code>Overall</code> strat as individual models. We have deleted the legend as it is not informative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span></span>
<span>  strat <span class="op">=</span> <span class="st">"Overall"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"c_index"</span>,</span>
<span>  `Framingham Women` <span class="op">=</span> <span class="va">women_model</span>,</span>
<span>  `Framingham Men` <span class="op">=</span> <span class="va">men_model</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot.html">get_forestplot</a></span><span class="op">(</span>center <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-forestplot-non-stratified" class="quarto-float quarto-figure quarto-figure-center" alt="C-Index forestplot with two models ">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-forestplot-non-stratified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-forestplot-non-stratified-1.png" alt="C-Index forestplot with two models " width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-forestplot-non-stratified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 6: Forestplot non-stratified
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level3"><h4 id="brier-score-comparison-forestplot">Brier Score Comparison: Forestplot<a class="anchor" aria-label="anchor" href="#brier-score-comparison-forestplot"></a>
</h4>
<p>The forestplot functions also allow us to generate the data from the Brier score results. The next code snippet generates a forestplot that compares the different Brier score in each model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span></span>
<span>    strat <span class="op">=</span> <span class="st">"Original"</span>, type <span class="op">=</span> <span class="st">"brier_score"</span>,</span>
<span>    Men <span class="op">=</span> <span class="va">men_model</span>, Women <span class="op">=</span> <span class="va">women_model</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span></span>
<span>    strat <span class="op">=</span> <span class="st">"Type 1 recalibration"</span>, type <span class="op">=</span> <span class="st">"brier_score_type_1"</span>,</span>
<span>    Men <span class="op">=</span> <span class="va">men_model</span>, Women <span class="op">=</span> <span class="va">women_model</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot_data.html">get_forestplot_data</a></span><span class="op">(</span></span>
<span>    strat <span class="op">=</span> <span class="st">"Type 2 recalibration"</span>, type <span class="op">=</span> <span class="st">"brier_score_type_2"</span>,</span>
<span>    Men <span class="op">=</span> <span class="va">men_model</span>, Women <span class="op">=</span> <span class="va">women_model</span></span>
<span>  <span class="op">)</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">MiceExtVal</span><span class="fu">::</span><span class="fu"><a href="../reference/get_forestplot.html">get_forestplot</a></span><span class="op">(</span>center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="st">"estimate"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div id="fig-forestplot-brier-score" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig"><div aria-describedby="fig-forestplot-brier-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="get-started-surv_files/figure-html/fig-forestplot-brier-score-1.png" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-forestplot-brier-score-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 7: Forestplot Brier score comparison
</figcaption></figure>
</div>
</div>
</div>
</section><section class="level2 unnumbered"><h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-vanBuuren2018" class="csl-entry" role="listitem">
Buuren, S. van. (2018). <em>Flexible imputation of missing data, second edition</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780429492259" class="external-link">https://doi.org/10.1201/9780429492259</a>
</div>
<div id="ref-mice-package" class="csl-entry" role="listitem">
van Buuren, S., &amp; Groothuis-Oudshoorn, K. (2011). <span class="nocase">mice</span>: Multivariate imputation by chained equations in r. <em>Journal of Statistical Software</em>, <em>45</em>(3), 1–67. <a href="https://doi.org/10.18637/jss.v045.i03" class="external-link">https://doi.org/10.18637/jss.v045.i03</a>
</div>
<div id="ref-framingham" class="csl-entry" role="listitem">
Wilson, P. W. F., D’Agostino, R. B., Levy, D., Belanger, A. M., Silbershatz, H., &amp; Kannel, W. B. (1998). Prediction of coronary heart disease using risk factor categories. <em>Circulation</em>, <em>97</em>(18), 1837–1847. <a href="https://doi.org/10.1161/01.CIR.97.18.1837" class="external-link">https://doi.org/10.1161/01.CIR.97.18.1837</a>
</div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Asier Ballesteros Domínguez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
